/*
 *	Plugin: Positioner
 *//*jshint jquery:true smarttabs:true*//*global define*/(function(e){typeof define=="function"&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){"use strict";var t={getRandomFromArray:function(e){return e[Math.floor(Math.random()*e.length)]},getRandomNumber:function(e){return Math.floor(Math.random()*e)},resizeWithAspectRatio:function(e,t,n,r){if(!e||!t)return!1;var i=e/t;return r?n=Math.ceil(r*i):r=Math.ceil(n/i),{height:n,width:r}},checkForCollisions:function(e,t){if(!t.length)return!1;var n=!1;for(var r=0;r<t.length;r++){var i=t[r];if(e[0][0]>=i[0][0]&&e[0][0]<=i[1][0]&&e[0][1]>=i[0][1]&&e[0][1]<=i[3][1]||e[1][0]>=i[0][0]&&e[1][0]<=i[1][0]&&e[1][1]>=i[0][1]&&e[1][1]<=i[3][1]||e[2][0]>=i[0][0]&&e[2][0]<=i[1][0]&&e[2][1]>=i[0][1]&&e[2][1]<=i[3][1]||e[3][0]>=i[0][0]&&e[3][0]<=i[1][0]&&e[3][1]>=i[0][1]&&e[3][1]<=i[3][1]||i[0][0]>=e[0][0]&&i[0][0]<=e[1][0]&&i[0][1]>=e[0][1]&&i[0][1]<=e[3][1]||i[1][0]>=e[0][0]&&i[1][0]<=e[1][0]&&i[1][1]>=e[0][1]&&i[1][1]<=e[3][1]||i[2][0]>=e[0][0]&&i[2][0]<=e[1][0]&&i[2][1]>=e[0][1]&&i[2][1]<=e[3][1]||i[3][0]>=e[0][0]&&i[3][0]<=e[1][0]&&i[3][1]>=e[0][1]&&i[3][1]<=e[3][1])n=!0}return n}},n=function(t,n){this.$el=t,this.$el.css({position:"relative"}),this.options=e.extend({},e.fn.positioner.defaults,n),this.width=this.$el.width()-this.options.containerPadding[1]-this.options.containerPadding[3],this.height=this.$el.height()-this.options.containerPadding[0]-this.options.containerPadding[2],this.area=this.width*this.height,this.$items=this.$el.find(n.item),this.count=this.$items.length,this.filledAreas=[],this.requiredArea=0,this.iterator=0,this.getData();for(var r=0;r<this.$items.length;r++){var i=this.$items.eq(r);this.positionItem(i)}this.$items.on("removepositioning",e.proxy(this.removeItemPositioning,this)),this.$el.on("removeallpositioning",e.proxy(this.removeAllPositioning,this))};n.prototype={getData:function(){this.filledAreas=[],this.iterator=0;for(var e=0;e<this.$items.length;e++){var t=this.$items.eq(e);this.getDimensions(t),this.getOkCoordinates(t)}},getDimensions:function(e){var n=e.outerWidth(),r=e.outerHeight(),i=Math.floor(Math.random()*this.options.widths.length),s=this.options.widths[i],o=this.options.classes[i],u=t.resizeWithAspectRatio(r,n,null,s),a=(u.height+this.options.margin)*(u.width+this.options.margin);e.data("Positioner.dimensions",u).addClass(o),this.requiredArea=this.requiredArea+a},getOkCoordinates:function(e){this.whileIterator=0;var n=e.data("Positioner.dimensions"),r=n.height,i=n.width,s=n.height+this.options.margin,o=n.width+this.options.margin,u=this.width-i-this.options.margin,a=this.height-r-this.options.margin,f=t.getRandomNumber(u),l=t.getRandomNumber(a),c=[f,l],h=[f+o,l],p=[f+o,l+s],d=[f,l+s],v=[c,h,p,d];while(t.checkForCollisions(v,this.filledAreas)){n=e.data("Positioner.dimensions"),r=n.height,i=n.width,f=t.getRandomNumber(u),l=t.getRandomNumber(a),c=[f,l],h=[f+o,l],p=[f+o,l+s],d=[f,l+s],v=[c,h,p,d],this.whileIterator++,this.whileIterator>100&&this.increaseElementSize();if(this.iterator>3){this.getData();break}}e.data("Positioner.coordinates",{left:f,top:l}),this.filledAreas.push(v)},positionItem:function(e){var t=e.data("Positioner.dimensions"),n=e.data("Positioner.coordinates");e.css({position:"absolute",height:t.height,width:t.width,left:n.left+this.options.containerPadding[3],top:n.top+this.options.containerPadding[0]})},increaseElementSize:function(){var e=this.width+200;this.$el.css({width:e}),this.width=e,this.iterator++,this.whileIterator=0},removeItemPositioning:function(t){e(t.target).css({top:"",left:"",position:"relative"})},removeAllPositioning:function(){this.$items.each(function(){e(this).css({top:"",left:"",position:"relative"})})}},e.fn.positioner=function(t){return this.each(function(){var r=e(this);new n(r,t)}),this},e.fn.positioner.defaults={classes:[],containerPadding:[0,0,0,0],dimensionToExpand:"width",margin:0,item:null,widths:[]}});